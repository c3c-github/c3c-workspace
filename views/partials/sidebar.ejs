<aside id="sidebar" class="fixed inset-y-0 left-0 w-64 bg-white border-r border-gray-100 flex flex-col z-40 transform -translate-x-full md:translate-x-0 transition-transform duration-300 shadow-xl md:shadow-none">
    
    <div class="h-16 md:h-20 flex items-center px-6 md:px-8 border-b border-gray-50 justify-between bg-white shrink-0">
        <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-c3c-gradient rounded-lg flex items-center justify-center text-white font-bold text-xs">C3C</div>
            <span class="font-bold text-gray-800 tracking-wide text-lg">Workplace</span>
        </div>
        <button onclick="toggleMenu()" class="md:hidden text-gray-400 hover:text-gray-600 focus:outline-none">
            <i data-lucide="x" class="w-6 h-6"></i>
        </button>
    </div>

    <nav class="flex-1 py-6 space-y-1 overflow-y-auto">
        
        <p class="px-6 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">Principal</p>
        
        <a href="/dashboard" class="nav-item <%= (typeof page !== 'undefined' && page === 'home') ? 'bg-[#EEF2FF] text-[#2978FF] border-r-4 border-[#2978FF]' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
            <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
            <span class="font-medium text-sm">Visão Geral</span>
        </a>

        <a href="/timesheet" class="nav-item <%= (typeof page !== 'undefined' && page === 'timesheet') ? 'bg-[#EEF2FF] text-[#2978FF] border-r-4 border-[#2978FF]' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
            <i data-lucide="clock" class="w-5 h-5"></i>
            <span class="font-medium text-sm">Minhas Horas</span>
        </a>

        <% if (user.grupos && user.grupos.includes('OPERACAO')) { %>
            <a href="/operations" class="nav-item <%= (typeof page !== 'undefined' && page === 'operations') ? 'bg-[#EEF2FF] text-[#2978FF] border-r-4 border-[#2978FF]' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
                <i data-lucide="headset" class="w-5 h-5"></i>
                <span class="font-medium text-sm">Mesa de Operações</span>
            </a>
        <% } %>

        <% if (user.grupos && user.grupos.includes('GESTOR')) { %>
            <p class="px-6 text-xs font-semibold text-gray-400 uppercase tracking-wider mt-8 mb-2">Serviços</p>
            <a href="/approvals" class="nav-item <%= (typeof page !== 'undefined' && page === 'approvals') ? 'bg-[#EEF2FF] text-[#2978FF] border-r-4 border-[#2978FF]' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
                <i data-lucide="check-square" class="w-5 h-5"></i>
                <span class="font-medium text-sm">Aprovação de Horas</span>
            </a>
        <% } %>

        <% if (user.grupos && user.grupos.includes('GESTOR_FINANCEIRO')) { %>
            <p class="px-6 text-xs font-semibold text-gray-400 uppercase tracking-wider mt-8 mb-2">Financeiro</p>
            <a href="/services" class="nav-item <%= (typeof page !== 'undefined' && page === 'services') ? 'bg-[#EEF2FF] text-[#2978FF] border-r-4 border-[#2978FF]' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
                <i data-lucide="briefcase" class="w-5 h-5"></i>
                <span class="font-medium text-sm">Gestão de Serviços</span>
            </a>
        <% } %>

        <% if (user.grupos && user.grupos.includes('ADMIN_RH')) { %>
            <p class="px-6 text-xs font-semibold text-gray-400 uppercase tracking-wider mt-8 mb-2">RH & Pessoas</p>
            <a href="/hr" class="nav-item <%= (typeof page !== 'undefined' && page === 'hr') ? 'bg-[#F3E8FF] text-purple-700 border-r-4 border-purple-600' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
                <i data-lucide="users" class="w-5 h-5"></i>
                <span class="font-medium text-sm">Gestão de Ponto</span>
            </a>
        <% } %>

        <% if (user.grupos && user.grupos.includes('GESTAO_SUPORTE')) { %>
            <p class="px-6 text-xs font-semibold text-gray-400 uppercase tracking-wider mt-8 mb-2">Estratégico</p>
            <a href="/support-management" class="nav-item <%= (typeof page !== 'undefined' && page === 'support_management') ? 'bg-[#EEF2FF] text-[#2978FF] border-r-4 border-[#2978FF]' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900' %> flex items-center gap-3 px-6 py-3 transition-colors">
                <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
                <span class="font-medium text-sm">Gestão de Suporte</span>
            </a>
        <% } %>

    </nav>

    <div class="p-4 border-t border-gray-50 bg-gray-50/50 shrink-0">
        <div class="flex items-center gap-3 p-2">
            <div class="w-10 h-10 rounded-full bg-blue-100 text-blue-600 border border-blue-200 flex items-center justify-center font-bold">
                <%= user.nome.charAt(0) %>
            </div>
            <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-gray-900 truncate"><%= user.nome %></p>
                <p class="text-xs text-gray-500 truncate" title="<%= user.grupos ? user.grupos.join(', ') : 'Colaborador' %>">
                    <% if (user.grupos && user.grupos.length > 0) { %>
                        <% 
                           const nomes = user.grupos.map(g => {
                               if(g === 'ADMIN_RH') return 'RH';
                               if(g === 'GESTOR') return 'Gestão';
                               if(g === 'OPERACAO') return 'N2';
                               return g;
                           });
                        %>
                        <%= nomes.join(' & ') %>
                    <% } else { %>
                        Colaborador
                    <% } %>
                </p>
            </div>
            <a href="/logout" title="Sair">
                <i data-lucide="log-out" class="w-4 h-4 text-gray-400 cursor-pointer hover:text-red-500 transition-colors"></i>
            </a>
        </div>
    </div>
</aside>